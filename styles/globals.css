/* Import Tailwind's layers - this must be at the top */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Import Google Fonts for better typography */
@import url('https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap');

/* Base layer - fundamental styles and CSS custom properties */
@layer base {
  /* CSS Variables for consistent theming */
  :root {
    /* Color scheme helps browser pick appropriate form styles */
    color-scheme: light;
    
    /* Custom properties for dynamic values */
    --header-height: 64px;
    --footer-height: 200px;
    
    /* Smooth scrolling for anchor links */
    scroll-behavior: smooth;
  }

  /* Remove tap highlight on mobile for cleaner interactions */
  * {
    -webkit-tap-highlight-color: transparent;
  }

  /* Better focus styles for accessibility */
  *:focus-visible {
    outline: 2px solid #1A3C8C;
    outline-offset: 2px;
  }

  /* Ensure images and videos are responsive by default */
  img, video {
    max-width: 100%;
    height: auto;
  }

  /* Better default typography */
  body {
    /* Mobile-first: start with smaller line height */
    line-height: 1.5;
    /* Smooth font rendering on all devices */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Responsive typography for better mobile reading */
  @media (min-width: 768px) {
    body {
      line-height: 1.6;
    }
  }

  /* Headings should have tighter line height */
  h1, h2, h3, h4, h5, h6 {
    line-height: 1.2;
  }
}

/* Component layer - reusable component styles */
@layer components {
  /* Primary button style - mobile-first with large touch targets */
  .btn-primary {
    @apply px-6 py-3 bg-marian-blue-500 text-white rounded-lg font-semibold;
    @apply hover:bg-marian-blue-600 active:bg-marian-blue-700;
    @apply transition-colors duration-200;
    @apply touch-manipulation; /* Prevents delay on touch devices */
    /* Minimum touch target size for mobile (48x48px recommended by Google) */
    min-height: 48px;
    min-width: 48px;
  }

  /* Secondary button style */
  .btn-secondary {
    @apply px-6 py-3 bg-white border-2 border-marian-blue-500 text-marian-blue-500 rounded-lg font-semibold;
    @apply hover:bg-marian-blue-50 active:bg-marian-blue-100;
    @apply transition-colors duration-200;
    @apply touch-manipulation;
    min-height: 48px;
    min-width: 48px;
  }

  /* Container with mobile-first padding */
  .container-mobile {
    @apply px-4 mx-auto;
    @apply sm:px-6;
    @apply lg:px-8;
    @apply max-w-7xl;
  }

  /* Card component for memorial cards */
  .memorial-card {
    @apply bg-white rounded-xl shadow-sm border border-gray-100;
    @apply p-4 sm:p-6;
    @apply hover:shadow-md transition-shadow duration-200;
  }

  /* Text styles with fluid typography */
  .text-hero {
    @apply text-fluid-3xl sm:text-fluid-4xl font-serif font-bold;
  }

  .text-title {
    @apply text-fluid-2xl sm:text-fluid-3xl font-serif font-semibold;
  }

  .text-subtitle {
    @apply text-fluid-lg sm:text-fluid-xl font-sans text-gray-600;
  }

  .text-body {
    @apply text-fluid-base font-sans text-gray-700;
  }

  /* ========== FORM COMPONENT STYLES ========== */
  
  /* Form Input Container */
  .form-input-container {
    @apply w-full min-w-0;
  }

  /* Form Input Label */
  .form-input-label {
    @apply block text-sm font-medium text-gray-700 mb-1;
  }

  /* Form Input Wrapper - handles overflow for date inputs */
  .form-input-wrapper {
    @apply relative min-w-0 w-full;
  }

  /* Special wrapper for date inputs to prevent mobile overflow */
  .date-input-wrapper {
    @apply overflow-hidden;
  }

  /* Base Form Input Styles */
  .form-input {
    @apply w-full px-4 py-3;
    @apply border border-gray-300 rounded-lg;
    @apply text-gray-900 placeholder-gray-400;
    @apply transition-colors duration-200;
    @apply focus:ring-2 focus:ring-marian-blue-500 focus:border-transparent;
    @apply disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed;
    
    /* Ensure proper box model */
    box-sizing: border-box;
  }

  /* Date Input Specific Styles - Fixes mobile overflow */
  .form-input-date {
    /* Force date inputs to respect container width on mobile */
    min-width: 0 !important;
    max-width: 100% !important;
    
    /* iOS Safari date input fixes */
    -webkit-appearance: none;
    appearance: none;
  }
  
  /* Restore native date picker on focus */
  .form-input-date::-webkit-calendar-picker-indicator {
    @apply cursor-pointer opacity-70 hover:opacity-100;
  }
  
  /* Android Chrome fixes */
  .form-input-date::-webkit-datetime-edit-fields-wrapper {
    @apply p-0;
  }

  /* Error State */
  .form-input-error {
    @apply border-red-500 focus:ring-red-500;
  }

  /* Hint Text */
  .form-input-hint {
    @apply mt-1 text-sm text-gray-500;
  }

  /* Error Message */
  .form-input-error-message {
    @apply mt-1 text-sm text-red-600;
  }

  /* Form Group for Grid Layouts */
  .form-group {
    @apply grid gap-4;
    
    /* Prevent grid blowout on mobile */
    @apply min-w-0;
  }
  
  /* Ensure all children respect grid boundaries */
  .form-group > * {
    @apply min-w-0;
  }

  /* Form Section Spacing */
  .form-section {
    @apply space-y-6;
  }

  /* Form Actions Container */
  .form-actions {
    @apply flex flex-col sm:flex-row gap-4 pt-4;
  }
}

/* Utility layer - one-off utilities */
@layer utilities {
  /* Safe area padding for mobile devices with notches */
  .safe-padding-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-padding-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Prevent text selection for UI elements */
  .no-select {
    user-select: none;
    -webkit-user-select: none;
  }

  /* Improved touch scrolling for mobile */
  .touch-scroll {
    -webkit-overflow-scrolling: touch;
    overflow-y: auto;
  }

  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
}

/* Mobile-specific form fixes */
@media (max-width: 640px) {
  /* Ensure date inputs don't cause horizontal scroll */
  input[type="date"],
  input[type="datetime-local"],
  input[type="time"],
  input[type="month"],
  input[type="week"] {
    min-width: 0 !important;
    width: 100% !important;
  }
  
  /* iOS specific fixes */
  @supports (-webkit-touch-callout: none) {
    input[type="date"],
    input[type="datetime-local"] {
      min-height: 48px; /* Apple's recommended touch target */
    }
  }
}

/* Print styles for memorial pages */
@media print {
  /* Hide navigation and interactive elements when printing */
  nav, footer, button, .no-print {
    display: none !important;
  }

  /* Ensure memorial content prints nicely */
  .memorial-content {
    max-width: 100%;
    margin: 0;
    padding: 0;
  }
}